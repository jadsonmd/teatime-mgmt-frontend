<div class="center-div">
  <h1>Registrar Uso</h1>

  <form class="registrar-uso-form" (onSubmit)="onSubmit()">
    <div class="produto-input">
      <app-produto-input
        (produtoSelecionadoEvent)="selecionaProduto($event)"
      ></app-produto-input>
    </div>

    <div class="actions">
      <button mat-button (click)="buscarItensProduto()">Buscar itens</button>
    </div>

    <div class="form-fields">
      <mat-selection-list
        #itens
        [multiple]="false"
        (selectionChange)="getItemSelecionado(itens.selectedOptions.selected)"
      >
        <mat-list-option *ngFor="let item of produtoItens" [value]="item">
          <div>
            <span>{{ item.lote }}</span>
            <span>{{ item.dataValidade | date : "dd/MM/yyyy" }}</span>
            <span>{{ item.quantidade }}</span>
          </div>
        </mat-list-option>
      </mat-selection-list>
    </div>

    <br />

    <div class="form-fields">
      <mat-form-field appearance="outline">
        <mat-label>Unidade</mat-label>
        <mat-select [(ngModel)]="registrarUso.idUnidade" name="registrarUso.idUnidade">
          <mat-option
            *ngFor="let unidade of unidades | async"
            [value]="unidade.id"
          >
            {{ unidade.nome }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline" >
        <mat-label>Data validade</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          [(ngModel)]="registrarUso.dataHora"
          name="registrarUso.dataHora"
          required
          appDateMask
        />
        <mat-datepicker-toggle
          matIconSuffix
          [for]="picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="actions">
      <button mat-button (click)="limparCampos()">Limpar</button>
      <button mat-flat-button color="primary" (click)="onSubmit()">
        Salvar
      </button>
    </div>
  </form>
</div>
